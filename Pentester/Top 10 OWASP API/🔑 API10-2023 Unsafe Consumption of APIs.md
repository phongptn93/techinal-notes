#### **1️⃣ Giới thiệu**

🔍 **Unsafe Consumption of APIs** xảy ra khi ứng dụng **tin tưởng hoàn toàn vào API bên ngoài** mà không kiểm tra hoặc xác thực dữ liệu trả về. Điều này có thể dẫn đến các cuộc tấn công chuỗi cung ứng API, dữ liệu bị giả mạo, hoặc thực thi mã độc hại trong hệ thống.

📌 **Ví dụ:**  
Một ứng dụng lấy dữ liệu từ API bên thứ ba mà không kiểm tra nội dung:
```http
GET /api/external/data
```
🚨 Nếu API bên thứ ba bị xâm phạm, nó có thể **trả về dữ liệu độc hại hoặc mã độc**, gây ảnh hưởng đến hệ thống và người dùng!

🖼 **Hình minh họa về Unsafe API Consumption:**  
![[Pasted image 20250225170129.png]]
---
#### **2️⃣ Cách thức khai thác 🕵️‍♂️**

Mặc dù không có cách khai thác trực tiếp như các lỗ hổng khác, nhưng có nhiều kịch bản rủi ro phổ biến:

- **📥 API bị xâm nhập trả về mã độc** → Ứng dụng tin tưởng và xử lý dữ liệu sai.
- **🎭 API giả mạo hoặc bị thay thế** → Gửi dữ liệu sai lệch, gây ảnh hưởng đến quyết định của hệ thống.
- **🔗 Thiếu xác thực API** → Ứng dụng tiêu thụ API không an toàn mà không kiểm tra nguồn gốc.
- **📊 JSON/XML Injection** → API trả về payload chứa script độc hại, dẫn đến XSS hoặc SQL Injection.
- **🖥 Dependency Hijacking** → Ứng dụng sử dụng thư viện bên thứ ba chứa mã độc.

---
#### **3️⃣ Cách ngăn chặn 🛡**

✅ **Kiểm tra dữ liệu từ API bên thứ ba trước khi xử lý.**  
✅ **Xác thực nguồn API trước khi tiêu thụ (OAuth, HMAC, TLS).**  
✅ **Dùng danh sách trắng (whitelist) để chỉ cho phép API đáng tin cậy.**  
✅ **Thực hiện kiểm tra dữ liệu đầu vào và đầu ra để phát hiện nội dung bất thường.**  
✅ **Áp dụng chính sách Content Security Policy (CSP) để ngăn chặn XSS và mã độc.**  
✅ **Cập nhật API và thư viện thường xuyên để tránh rủi ro từ dependency.**