### **1️⃣ Giới thiệu**

🔓 Lỗ hổng **Broken Authentication** xảy ra khi API không bảo vệ quy trình xác thực đúng cách, khiến kẻ tấn công có thể **chiếm đoạt tài khoản, giả mạo người dùng hoặc truy cập dữ liệu trái phép**.

📌 **Nguyên nhân phổ biến:**  
❌ Không giới hạn số lần thử đăng nhập (Brute-force).  
❌ Dùng mật khẩu yếu hoặc không mã hóa đúng cách.  
❌ Lưu trữ API Key hoặc JWT Token không an toàn.  
❌ Không có xác thực đa yếu tố (MFA).

🖼 **Hình minh họa về Broken Authentication:**  

![[Pasted image 20250225164327.png]]
---

### **2️⃣ Cách thức khai thác 🔥**

👨‍💻 Kẻ tấn công có thể lợi dụng:

- **🔢 Brute-force Attack:** Dùng danh sách mật khẩu phổ biến để đăng nhập thử.
- **🎭 Credential Stuffing:** Dùng thông tin đăng nhập rò rỉ từ các trang web khác.
- **🕵️‍♂️ Session Hijacking:** Đánh cắp token từ URL hoặc local storage để truy cập tài khoản.
- **⏳ Token Reuse:** Nếu token không hết hạn đúng cách, kẻ xấu có thể tiếp tục sử dụng.

📌 **Ví dụ thực tế:**

```http
POST /api/login {    "username": "admin",    "password": "password123" }`
```
🚨 Nếu API không kiểm soát đăng nhập sai nhiều lần, kẻ tấn công có thể brute-force tài khoản!

---

### **3️⃣ Cách ngăn chặn 🛡**

✅ **Bắt buộc sử dụng xác thực đa yếu tố (MFA).**  
✅ **Giới hạn số lần thử đăng nhập và sử dụng CAPTCHA.**  
✅ **Mã hóa mật khẩu bằng bcrypt hoặc Argon2.**  
✅ **Dùng token với thời gian sống hợp lý (short-lived JWT) và refresh token an toàn.**  
✅ **Không lưu trữ token trên LocalStorage, sử dụng HttpOnly cookies.**  
✅ **Triển khai cơ chế kiểm tra thiết bị đăng nhập (Device Fingerprinting).**

https://portswigger.net/web-security/authentication
https://portswigger.net/web-security/jwt
https://portswigger.net/web-security/authentication/password-based/lab-username-enumeration-via-different-responses