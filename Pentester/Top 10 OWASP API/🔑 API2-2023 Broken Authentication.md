### **1ï¸âƒ£ Giá»›i thiá»‡u**

ğŸ”“ Lá»— há»•ng **Broken Authentication** xáº£y ra khi API khÃ´ng báº£o vá»‡ quy trÃ¬nh xÃ¡c thá»±c Ä‘Ãºng cÃ¡ch, khiáº¿n káº» táº¥n cÃ´ng cÃ³ thá»ƒ **chiáº¿m Ä‘oáº¡t tÃ i khoáº£n, giáº£ máº¡o ngÆ°á»i dÃ¹ng hoáº·c truy cáº­p dá»¯ liá»‡u trÃ¡i phÃ©p**.

ğŸ“Œ **NguyÃªn nhÃ¢n phá»• biáº¿n:**  
âŒ KhÃ´ng giá»›i háº¡n sá»‘ láº§n thá»­ Ä‘Äƒng nháº­p (Brute-force).  
âŒ DÃ¹ng máº­t kháº©u yáº¿u hoáº·c khÃ´ng mÃ£ hÃ³a Ä‘Ãºng cÃ¡ch.  
âŒ LÆ°u trá»¯ API Key hoáº·c JWT Token khÃ´ng an toÃ n.  
âŒ KhÃ´ng cÃ³ xÃ¡c thá»±c Ä‘a yáº¿u tá»‘ (MFA).

ğŸ–¼ **HÃ¬nh minh há»a vá» Broken Authentication:**  

![[Pasted image 20250225164327.png]]
---

### **2ï¸âƒ£ CÃ¡ch thá»©c khai thÃ¡c ğŸ”¥**

ğŸ‘¨â€ğŸ’» Káº» táº¥n cÃ´ng cÃ³ thá»ƒ lá»£i dá»¥ng:

- **ğŸ”¢ Brute-force Attack:** DÃ¹ng danh sÃ¡ch máº­t kháº©u phá»• biáº¿n Ä‘á»ƒ Ä‘Äƒng nháº­p thá»­.
- **ğŸ­ Credential Stuffing:** DÃ¹ng thÃ´ng tin Ä‘Äƒng nháº­p rÃ² rá»‰ tá»« cÃ¡c trang web khÃ¡c.
- **ğŸ•µï¸â€â™‚ï¸ Session Hijacking:** ÄÃ¡nh cáº¯p token tá»« URL hoáº·c local storage Ä‘á»ƒ truy cáº­p tÃ i khoáº£n.
- **â³ Token Reuse:** Náº¿u token khÃ´ng háº¿t háº¡n Ä‘Ãºng cÃ¡ch, káº» xáº¥u cÃ³ thá»ƒ tiáº¿p tá»¥c sá»­ dá»¥ng.

ğŸ“Œ **VÃ­ dá»¥ thá»±c táº¿:**

```http
POST /api/login {    "username": "admin",    "password": "password123" }`
```
ğŸš¨ Náº¿u API khÃ´ng kiá»ƒm soÃ¡t Ä‘Äƒng nháº­p sai nhiá»u láº§n, káº» táº¥n cÃ´ng cÃ³ thá»ƒ brute-force tÃ i khoáº£n!

---

### **3ï¸âƒ£ CÃ¡ch ngÄƒn cháº·n ğŸ›¡**

âœ… **Báº¯t buá»™c sá»­ dá»¥ng xÃ¡c thá»±c Ä‘a yáº¿u tá»‘ (MFA).**  
âœ… **Giá»›i háº¡n sá»‘ láº§n thá»­ Ä‘Äƒng nháº­p vÃ  sá»­ dá»¥ng CAPTCHA.**  
âœ… **MÃ£ hÃ³a máº­t kháº©u báº±ng bcrypt hoáº·c Argon2.**  
âœ… **DÃ¹ng token vá»›i thá»i gian sá»‘ng há»£p lÃ½ (short-lived JWT) vÃ  refresh token an toÃ n.**  
âœ… **KhÃ´ng lÆ°u trá»¯ token trÃªn LocalStorage, sá»­ dá»¥ng HttpOnly cookies.**  
âœ… **Triá»ƒn khai cÆ¡ cháº¿ kiá»ƒm tra thiáº¿t bá»‹ Ä‘Äƒng nháº­p (Device Fingerprinting).**

https://portswigger.net/web-security/authentication
https://portswigger.net/web-security/jwt
https://portswigger.net/web-security/authentication/password-based/lab-username-enumeration-via-different-responses