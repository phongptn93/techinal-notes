### **1️⃣ Giới thiệu**

🔍 **Broken Function Level Authorization (BFLA)** xảy ra khi API không phân biệt quyền truy cập giữa các chức năng khác nhau, cho phép người dùng thông thường thực hiện các hành động đặc quyền.

📌 **Ví dụ:**  
🛑 Người dùng thông thường cố gắng truy cập API quản trị viên:

```http
GET /api/admin/users

```
🚨 Nếu API không kiểm tra quyền, người dùng có thể **xem hoặc chỉnh sửa dữ liệu của toàn bộ hệ thống!**

🖼 **Hình minh họa về khai thác BFLA:**  

![[Pasted image 20250225164604.png]]

![[Pasted image 20250225164610.png]]

---
### **2️⃣ Cách thức khai thác 🕵️‍♂️**

- **🚀 Truy cập API quản trị viên mà không có quyền.**
- **🛠 Thay đổi phương thức HTTP từ `GET` thành `POST` hoặc `DELETE`.**
- **📥 Sử dụng API của nhân viên hoặc đối tác để truy cập dữ liệu không được phép.**

📌 **Ví dụ thực tế:**

```http
POST /api/admin/delete_user {     "user_id": "1234" }
```
🚨 Nếu API không kiểm tra quyền, bất kỳ ai cũng có thể xóa tài khoản người khác!

---
### **3️⃣ Cách ngăn chặn 🛡**

✅ **Áp dụng kiểm tra quyền theo vai trò (RBAC - Role-Based Access Control).**  
✅ **Không chỉ dựa vào frontend để kiểm soát quyền, phải xác minh tại backend.**  
✅ **Phân tách rõ ràng API dành cho người dùng thông thường và API dành cho quản trị viên.**  
✅ **Ghi log và giám sát các hành vi bất thường như truy cập API cao cấp từ tài khoản bình thường.**

https://portswigger.net/web-security/api-testing/lab-exploiting-api-endpoint-using-documentation