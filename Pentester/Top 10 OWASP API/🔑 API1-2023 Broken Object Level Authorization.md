### **1️⃣ Giới thiệu**

🔍 Lỗ hổng **BOLA (Broken Object Level Authorization)** xảy ra khi API không kiểm tra quyền truy cập một cách chính xác ở mức đối tượng. Điều này cho phép kẻ tấn công **truy cập, chỉnh sửa hoặc xóa dữ liệu của người khác** chỉ bằng cách thay đổi các tham số trong yêu cầu API.

🚨 Đây là một trong những lỗ hổng nguy hiểm nhất, vì nó thường xuất hiện ở **REST API, GraphQL, và gRPC**, ảnh hưởng lớn đến bảo mật dữ liệu.

📌 **Ví dụ:**  
Người dùng hợp lệ gửi yêu cầu lấy thông tin tài khoản:


```http
GET /api/users/1234`
```

🔴 Nếu API không kiểm tra quyền, kẻ tấn công có thể thay `1234` thành `5678` để truy cập dữ liệu của người khác:

```http
GET /api/users/5678`
```

🖼 **Hình minh họa về cách khai thác BOLA:**  
📌 _Kẻ tấn công chỉ cần thay đổi ID trong yêu cầu API để truy cập dữ liệu trái phép!_

![[Pasted image 20250225164712.png]]

![[Pasted image 20250225164717.png]]

---

### **2️⃣ Cách thức khai thác**

🕵️‍♂️ Kẻ tấn công thường sử dụng các phương pháp:

- **🔄 Thay đổi Object ID:** Dùng ID của người khác để truy cập dữ liệu trái phép.
- **🛠 Tấn công API không xác thực tốt:** Các API chỉ dựa vào ID được gửi từ phía client mà không xác minh quyền sở hữu dữ liệu.
- **📥 Lấy dữ liệu nhạy cảm:** API bị lỗi có thể trả về thông tin cá nhân (PII), tài khoản ngân hàng hoặc dữ liệu quan trọng khác.

---

### **3️⃣ Cách ngăn chặn 🛡**

✅ **Kiểm tra quyền truy cập ở cấp độ đối tượng:** Không chỉ kiểm tra xem người dùng đã đăng nhập mà còn phải xác minh họ có quyền với dữ liệu đó.  
✅ **Không tin tưởng dữ liệu từ client:** Đừng chỉ dựa vào ID do client gửi mà cần xác minh với server.  
✅ **Sử dụng UUID thay vì ID tăng dần:** Điều này làm cho việc đoán ID khó khăn hơn.  
✅ **Theo dõi & ghi log hoạt động API:** Cảnh báo khi có nhiều yêu cầu bất thường hoặc ID thay đổi liên tục.

https://apisecurity.io/encyclopedia/content/owasp/api1-broken-object-level-authorization
https://inonst.medium.com/a-deep-dive-on-the-most-critical-api-vulnerability-bola-1342224ec3f2.
https://portswigger.net/web-security/access-control
https://portswigger.net/web-security/access-control/lab-user-id-controlled-by-request-parameter
https://portswigger.net/web-security/access-control/lab-unprotected-admin-functionality